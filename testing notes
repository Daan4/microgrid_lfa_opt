after fiddling with optimize functions

least squares was selected, with cauchy loss (because we are non linear)
tweaked diff_step by hand until we got reasonable looking results for various initial guesses
put initial guess near what we thought to obtain first optimization results:

    # Initial result to try model with:
    # PV size 34.355 MWp ~$34 million cost assuming $1/Wp  https://www.solar.com/learn/solar-panel-cost/
    # battery size 666.322 MWh ~$92.5 million cost assuming $139/kWh
    # seems reasonable? Let's try it out!
    # https://atb.nrel.gov/electricity/2023/utility-scale_battery_storage stating $338 dollar per kwh in 21 for 60MW 600MWh battery which is similar to hours

minimized pv curtailment & diesel hours in initial try
if only diesel hours, system can become super large
I think it can be optimized further somehow by trying to minimize pv+battery while minimizing diesel hours

Then priority based control rules implemented, and tested with above optimization

From initial results this sizing seems way too big to be optimal, something wrong with objective function to give these results
I want to really try to use the pf output as an objective function!!!

Trying least squares but not really getting good results (should be cost based with constrains but doesnt support it)

dual annealing method seems to give good results

Initial result 713, 80564. PV seems okay but battery not well utilized
However lower battery results in worse results

Manual optimization:

750, 5000 seems like a good value

try pyswarm to look around those values
pyswarm comes up with 715PV 98259Batt.

new tactic
minimize cost with constraint that we have 90% diesel reduction

After minimizing for cost with constraint of 90% hours diesel reduction comes to following values
788 pv 2500 batt

Because objective is simplified & not exact diesel usage is calculated its a bit too high, so adjust to
95% reduction in hours


After implementing a mirror of the control function into pso and taking into account price we get
911 2293

pyswarm default settings, using system cost (simplified by looking at rough batt and pv cost) under condition of reducing

to 10% of original diesel usage
912PV 2273Batt - cost €1,973,849

using 0.09 to have some margin:
960 2209 €2,035,645

5%
1100PV 2454Batt - cost €2,315,312

1%
1288PV 3801Batt - cost €2,921,138
